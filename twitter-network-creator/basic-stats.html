<!doctype html>
<html lang="en">
<head>
  <title>Twitter Statistics</title>
  <meta charset="utf-8" />
 <link rel="stylesheet" href="/ext/css/d3.slider.css"/>  
 <link rel="stylesheet" href="/ext/css/bootstrap.min.css"/>  
  <link rel="stylesheet" href="/ext/css/dc.css"/> 
 <style>
 .hide {
  display:none;
 }
 .show{
  display:inline ;
 }
 </style>
 
</head>
<body ng-app="twitterstuff">
  <div class='container-fluid'>
    <div ng-controller="twitterselect">



 
      <div class='row'>
        <div class='col-lg-12 '>
        <h1 style='font-family: Helvetica'>
      Overall Twitter Statistics View
        </h1>
        </div>
      </div>
      <div class='row'>
       <div class='col-lg-12'>
        <div id="graph"></div>
        </div>
      </div>
      <div class="row">
          <div class="col-lg-12" id="monthly-move-chart">
              <strong>Monthly Index Abs Move & Volume/500,000 Chart</strong>
              <span class="reset" style="display: none;">range: <span class="filter"></span></span>
              <a class="reset" href="javascript:moveChart.filterAll();volumeChart.filterAll();dc.redrawAll();"
                 style="display: none;">reset</a>

              <div class="clearfix"></div>
          </div>
      </div>

      <div class="row">
          <div class="col-lg-12" id="monthly-volume-chart">
          </div>
          <p class="muted pull-right" style="margin-right: 15px;">select a time range to zoom in</p>
      </div>

      


      
    
    
    <script src="/ext/angular.js"></script>
    <script src="/ext/d3.v3.min.js"></script>
    <script src="/ext/crossfilter.js"></script>
     <script src="/ext/dc.js"></script>
   
    <script src="/ext/jquery.min.js"></script>
    <script src="/ext/d3.slider.js"></script>
    <script src="/ext/bootstrap.min.js"></script>
  



  <script>


  var termiteTopics = angular.module('twitterstuff', [], function($locationProvider) {
    $locationProvider.html5Mode(true);
  });

  termiteTopics.controller('twitterselect',['$scope', function($scope){

  var width = 1000
  var height = 1000

    var labelcols = 4

  labelenclosewidth = width

  var labelwidth = (width)/4 - 10
  var square = 15

  var textboxwidth = 170;

  var color = d3.scale.category20();

  var parseDate = d3.time.format("%a %b %d %X %Z %Y");

  var moveChart = dc.lineChart('#monthly-move-chart');
  var volumeChart = dc.barChart('#monthly-volume-chart');

  d3.json('basic_stats/9-11.json', function(error,graph){

    graph.stats.forEach(function(d){
      d.dd = parseDate(d.time)
      //d.day = d3.time.day(d.time)


    })



    var svg_labels = d3.select("#graph").append("svg")
      .attr('id', 'labelgraph')
      .attr("width", width)
      .attr("height", (graph.terms.length /labelcols) * 50)

     function labely(i, text){
        var row = 35
        var sq = square 
        if(text){
          sq  = 0
      }
       // var row = 20
        if( i < 4){
          return row - sq
        }
        if( i < 8){
          return row * 2  - sq
        }
        if( i < 12){
          return row * 3 - sq
        }
        if( i < 16){
          return row * 4 - sq
        }
        if( i < 20){
          return row * 5 - sq
        }
      }

    var labelgroups = svg_labels.selectAll('svg')
                .data(graph.terms)
                .enter()
                .append('svg')
                .attr('class', 'unselected')
                .attr('x', function(d, i) { return labelenclosewidth/labelcols *  (i % labelcols)})
                .attr('y', function(d, i) { return labely(i, false)})
                .attr('height', 35)
                .attr('width', labelwidth)
               // .on('click', selectHashtag)
                .on('mouseover', function(d){
                  d3.select(this).style('cursor', 'pointer')
                })


    var labelsquares = labelgroups.append('rect')
                      .style('fill', function(d, i){return color(i)})
                      .style('stroke', 'black')
                      .style('stroke-opacity', .2)
                      .attr('height', square)
                      .attr('width', square)
                      .attr('y', 3)
                      .attr('x', 5)

    var labeltext = labelgroups
            .append('text')
            .style('font-family', 'Helvetica')
            .attr('x', 25)
            .attr('y', 16)
            .text(function(d){return d})
    var selectionrects = labelgroups.append('rect')
                        .attr('x', 0)
                        .attr('y', 0)
                        .attr('id', function(d){
                          return 'select' + d
                        })
                        .style('rx', 4)
                        .style('ry', 4)
                        .attr('height', 22)
                        .attr('width', labelwidth)
                        .style('opacity', .1)


    console.log(graph.stats[0])

  })




  }]);
  </script>



</body>
</html>
