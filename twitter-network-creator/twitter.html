<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html lang="en">
<head>
<style>
  .bg-grey{
    background-color: #d3d3d3;
  }
</style>

</head>
<body ng-app="twitterstuff">
<div ng-controller="twitterselect">

<h1>
Twitter Networks for #BlackLivesMatter Dec 1-9
</h1>
 <!-- <h4>Change Year</h4>
          <select ng-model="day" ng-options="m for m in days" ng-change="viz()"></select>-->
<div id="graph" ></div>
</div>
</div>
<!-- Angular Material requires Angular.js Libraries -->
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-animate.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-aria.min.js"></script>
  <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular-messages.min.js"></script>

  <!-- Angular Material Library -->
  <script src="/ext/d3.v3.min.js"></script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>

<script>

var termiteTopics = angular.module('twitterstuff', [], function($locationProvider) {
  $locationProvider.html5Mode(true);
});

termiteTopics.controller('twitterselect',['$scope', function($scope){
var width = 700,
    height = 700,
    radius = 4,
    charge = -100,
    linkDistance = 30;
    noderadius = 2
    


 // linkDistance = 0.5714285714285714;
 linkDistance = 30



var color = ['black', 'yellow', 'blue', 'red', 'orange', 'green', 'pink' ]

/*$scope.days=[]
for(var i = 23; i < 31; i++){
  $scope.days.push(i)
}

$scope.day = 23*/

var force = d3.layout.force()
  .charge(charge)
  .linkDistance(linkDistance)
    .size([width, height]);



$scope.viz = function(){
  d3.select('#network').remove()

var svg = d3.select("#graph").append("svg")
  .attr("xmlns","http://www.w3.org/2000/svg")
    .attr("width", width)
    .attr("height", height)
    .attr('id', 'network')
    .attr('class', 'bg-grey');


d3.json("formatted_data/formatted9-20-BlackLivesMatterFergusonIfTheyGunnedMeDownHandsUpDontShootMichaelBrowntext.json", function(error, graph) {
  force
      .nodes(graph.nodes)
      .links(graph.links)
      .start();

  var link = svg.selectAll(".link")
      .data(graph.links)
    .enter().append("line")
      .attr("class", "link")
      .style("stroke-width", function(d) { return Math.sqrt(d.value); })
      .style('stroke', 'black')
      .style('stroke-opacity', .5);

  var text = svg.selectAll('.text')
    .data(graph.nodes)
    .enter().append('text')
    .attr('x', 100)
    .attr('y', 100)
    .style('font-family', 'Helvetica')
    //.style('font-size', '9px')
    .text(function(d){ return d.name});

  var node = svg.selectAll(".node")
      .data(graph.nodes)
    .enter().append("circle")
      .attr("class", "node")
     // .attr("r", function(d) { return Math.sqrt(d.retweets/Math.PI); })
      .attr("r", function(d) { if (d.retweets == 0){ return 1 * noderadius;} return Math.sqrt(d.retweets/Math.PI) * noderadius; })
      .style("fill", function(d) { return color[d.group]; })
       .call(force.drag);

  node.append("title")
      .text(function(d) { return 'username:' + d.name + '\ntext:' + d.text; });

  force.on("tick", function() {
    link.attr("x1", function(d) { return d.source.x; })
        .attr("y1", function(d) { return d.source.y; })
        .attr("x2", function(d) { return d.target.x; })
        .attr("y2", function(d) { return d.target.y; });

    node.attr("cx", function(d) { return d.x = Math.max(radius, Math.min(width - d.score, d.x)); })
        .attr("cy", function(d) { return d.y = Math.max(radius, Math.min(height - d.score, d.y)); });
  });


    text
      .attr('x', function(d) { return d.x = Math.max(radius, Math.min(width - d.score, d.x)); })
      .attr("y", function(d) { return d.y = Math.max(radius, Math.min(height - d.score, d.y)); });


});}
$scope.viz();
}]);
</script>



</body>
</html>
